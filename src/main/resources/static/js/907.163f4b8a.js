"use strict";(self["webpackChunkhelloworld"]=self["webpackChunkhelloworld"]||[]).push([[907],{65951:function(e,a,o){o.d(a,{N:function(){return s}});var r=o(77736);function s(){return(0,r.Z)({url:"/company/list",method:"get"})}},61437:function(e,a,o){o.d(a,{Kx:function(){return s},ie:function(){return l}});var r=o(77736);function s(e){return(0,r.Z)({url:"/supermarket/updateLicense",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}function l(e){return(0,r.Z)({url:"/supermarket/list",method:"get",params:e})}},56684:function(e,a,o){o.d(a,{Z:function(){return p}});var r=o(440);function s(e,a,o,s,l,t){const d=(0,r.up)("el-option"),m=(0,r.up)("el-select");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.Wm)(m,{modelValue:s.data.provinceObj,"onUpdate:modelValue":a[0]||(a[0]=e=>s.data.provinceObj=e),placeholder:"请选择",onChange:s.provinceChange,"value-key":"name",required:""},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.data.provinceData,((e,a)=>((0,r.wg)(),(0,r.j4)(d,{key:a,label:e.name,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),(0,r.Uk)("   "),(0,r.Wm)(m,{modelValue:s.data.cityObj,"onUpdate:modelValue":a[1]||(a[1]=e=>s.data.cityObj=e),placeholder:"请选择",onChange:s.cityChange,"value-key":"name",required:""},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.data.cityData,((e,a)=>((0,r.wg)(),(0,r.j4)(d,{key:a,label:e.name,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),(0,r.Uk)("   "),(0,r.Wm)(m,{modelValue:s.data.countryObj,"onUpdate:modelValue":a[2]||(a[2]=e=>s.data.countryObj=e),placeholder:"请选择",onChange:s.countryChange,"value-key":"name",required:""},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.data.countryData,((e,a)=>((0,r.wg)(),(0,r.j4)(d,{key:a,label:e.name,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),(0,r.Uk)("   ")])}var l=o(84367),t=o(66530),d=o(72349),m=o(39162),n={setup(){const e=(0,t.oR)(),a=e.state.address,o=(0,l.qj)({provinceObj:{name:""},cityObj:{name:""},countryObj:{name:""},provinceData:a.address,cityData:[],countryData:[]});(0,r.bv)((async()=>{await(0,d.g)().then((e=>{o.provinceData=e.data.address}))}));const s=e=>{o.cityData=e.children,o.countryData=[],o.cityObj={},o.countryObj={}},n=e=>{o.countryData=e.children,o.countryObj={}},u=e=>{m.log(o)};return{data:o,provinceChange:s,cityChange:n,countryChange:u}}},u=o(40465);const i=(0,u.Z)(n,[["render",s]]);var p=i},45907:function(e,a,o){o.r(a),o.d(a,{default:function(){return y}});var r=o(440),s=o(38643);const l={class:"user-container"},t={class:"dialog-footer"},d={class:"dialog-footer"};function m(e,a,o,m,n,u){const i=(0,r.up)("el-input"),p=(0,r.up)("el-form-item"),c=(0,r.up)("el-button"),f=(0,r.up)("el-form"),w=(0,r.up)("el-dialog"),h=(0,r.up)("el-upload");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",l,[(0,r.Wm)(f,{ref:"form",model:n.form,"label-width":"120px",autocomplete:"on"},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{label:"用户名",prop:"username"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{ref:"username",placeholder:"用户名",modelValue:n.form.user.username,"onUpdate:modelValue":a[0]||(a[0]=e=>n.form.user.username=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{label:"密码",prop:"password","aria-disabled":""},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{ref:"password",placeholder:"密码",modelValue:n.form.user.password,"onUpdate:modelValue":a[1]||(a[1]=e=>n.form.user.password=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{label:"邮箱",prop:"email"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{ref:"email",placeholder:"**@163.com,***@qq.com",modelValue:n.form.user.email,"onUpdate:modelValue":a[2]||(a[2]=e=>n.form.user.email=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{label:"电话号码",prop:"phone"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{placeholder:"请输入电话号码",modelValue:n.form.user.phone,"onUpdate:modelValue":a[3]||(a[3]=e=>n.form.user.phone=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{label:"公司",prop:"company"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:n.form.company.companyName,"onUpdate:modelValue":a[4]||(a[4]=e=>n.form.company.companyName=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{label:"超市名称",prop:"sname"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{placeholder:"超市名称",modelValue:n.form.supermark.sname,"onUpdate:modelValue":a[5]||(a[5]=e=>n.form.supermark.sname=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{label:"超市详细地址",prop:"sdetail"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{placeholder:"超市详细地址",modelValue:n.form.supermark.detail,"onUpdate:modelValue":a[6]||(a[6]=e=>n.form.supermark.detail=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{label:"地区",prop:"saddress"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:n.form.supermark.address,"onUpdate:modelValue":a[7]||(a[7]=e=>n.form.supermark.address=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{label:"证件",prop:"license"},{default:(0,r.w5)((()=>[(0,r._)("span",null,(0,s.zw)(this.form.supermark.license.name)+" ",1),(0,r.Wm)(c,{class:"upload-demo",onClick:u.Preview},{default:(0,r.w5)((()=>[(0,r.Uk)("预览")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"]),(0,r.Wm)(c,{type:"primary",onClick:a[8]||(a[8]=e=>n.PasswordFormVisible=!0)},{default:(0,r.w5)((()=>[(0,r.Uk)("修改密码")])),_:1}),(0,r.Wm)(c,{type:"primary",onClick:a[9]||(a[9]=e=>n.LicenseFormVisible=!0)},{default:(0,r.w5)((()=>[(0,r.Uk)("更新证件信息")])),_:1})]),(0,r.Wm)(w,{modelValue:n.PasswordFormVisible,"onUpdate:modelValue":a[13]||(a[13]=e=>n.PasswordFormVisible=e),title:"修改密码"},{footer:(0,r.w5)((()=>[(0,r._)("span",t,[(0,r.Wm)(c,{onClick:a[12]||(a[12]=e=>n.PasswordFormVisible=!1)},{default:(0,r.w5)((()=>[(0,r.Uk)("返回")])),_:1}),(0,r.Wm)(c,{type:"primary",onClick:u.UpdatePassword},{default:(0,r.w5)((()=>[(0,r.Uk)(" 修改密码 ")])),_:1},8,["onClick"])])])),default:(0,r.w5)((()=>[(0,r.Wm)(f,{ref:"passwordform",model:n.passwordform,rules:n.passwordRules},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{label:"新密码",prop:"password"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:n.passwordform.password,"onUpdate:modelValue":a[10]||(a[10]=e=>n.passwordform.password=e),"show-password":""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{label:"再次确认密码",prop:"mdfpassword"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:n.passwordform.mdfpassword,"onUpdate:modelValue":a[11]||(a[11]=e=>n.passwordform.mdfpassword=e),"show-password":""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),(0,r.Wm)(w,{modelValue:n.LicenseFormVisible,"onUpdate:modelValue":a[15]||(a[15]=e=>n.LicenseFormVisible=e),title:"更新证件"},{footer:(0,r.w5)((()=>[(0,r._)("span",d,[(0,r.Wm)(c,{onClick:a[14]||(a[14]=e=>n.LicenseFormVisible=!1)},{default:(0,r.w5)((()=>[(0,r.Uk)("返回")])),_:1}),(0,r.Wm)(c,{type:"primary",onClick:u.UpdateLicense},{default:(0,r.w5)((()=>[(0,r.Uk)(" 更新证件信息 ")])),_:1},8,["onClick"])])])),default:(0,r.w5)((()=>[(0,r.Wm)(f,{ref:"Licenseform",model:n.Licenseform,rules:n.LicenseRules},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{label:"证件上传",prop:"license"},{default:(0,r.w5)((()=>[(0,r.Wm)(h,{ref:"upload",class:"upload-demo",limit:1,"on-change":u.submitUpload,"auto-upload":!1},{trigger:(0,r.w5)((()=>[(0,r.Wm)(c,{type:"primary"},{default:(0,r.w5)((()=>[(0,r.Uk)("选择文件")])),_:1})])),_:1},8,["on-change"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])],64)}var n=o(56684),u=o(65951),i=o(21618),p=o(61437),c=o(3618),f=o(39162),w={components:{addressSelect:n.Z},created(){this.getCompanyList(),this.LoadUserMessage()},mounted(){""===this.form.username?this.$refs.username.focus():""===this.form.password?this.$refs.password.focus():""===this.form.mdfPassword?this.$refs.mdfPassword.focus():""==this.form.email&&this.$refs.email.focus()},data(){const e=(e,a,o)=>{var r=this.passwordform.password;""===r.trim()||r.length<6?o(new Error("密码不能为空且不得少于6个字符")):o()},a=(e,a,o)=>{var r=this.passwordform.password,s=this.passwordform.mdfpassword;r!=s?o(new Error("两次输入的密码不一致")):o()},o=(e,a,o)=>{0===Object.keys(this.Licenseform.license).length?o(new Error("证件信息不能为空")):o()};return{PasswordFormVisible:!1,LicenseFormVisible:!1,companies:{},form:{user:{username:"",password:"",email:"",phone:""},company:{companyId:"",companyName:""},supermark:{sname:"",detail:"",address:"",license:{name:"",url:""}}},passwordform:{password:"",mdfpassword:""},Licenseform:{license:{}},passwordRules:{password:[{required:!0,trigger:"blur",validator:e}],mdfpassword:[{required:!0,trigger:"blur",validator:a}]},LicenseRules:{license:[{required:!0,trigger:"blur",validator:o}]}}},methods:{submitUpload(e){this.Licenseform.license=e.raw},onSubmit(){this.$refs.form.validate((e=>{if(e){var a=/^([0-9a-zA-Z_\.\-\])+\@([0-9a-zA-Z_\.\-\])+\.([a-zA-Z]+)$/;this.form.user.mdfpassword!=this.form.user.userpassword?c.z8.error("两次输入的密码不同"):a.test(this.form.user.email)?(this.form.supermark.address=this.$refs.addressSelect.data.cityObj.code,f.info(this.$refs.upload),this.$store.dispatch("user/signUp",this.form).then().catch((e=>{f.info(e)}))):c.z8.error("邮箱格式错误，请重新输入")}}))},async getCompanyList(){let e={};await(0,u.N)().then((a=>{e=a.data})).catch(),this.companies=e},async LoadUserMessage(){let e={},a={},o={};await(0,i.FC)({token:this.$store.state.user.token}).then((r=>{const s=r.data;e=s.form.user,a=s.form.company,o=s.form.supermark})),this.form.user=e,this.form.company=a,this.form.supermark=o},Preview(){window.open(this.form.supermark.license.url,"_blank")},async UpdatePassword(){this.$refs.passwordform.validate((async e=>{e&&await(0,i.CY)({token:this.$store.state.user.token,password:this.passwordform.password}).then((e=>{(0,c.z8)({message:e.message,type:"success"}),this.LoadUserMessage(),this.PasswordFormVisible=!1}))}))},UpdateLicense(){this.$refs.Licenseform.validate((async e=>{if(e){const e=new FormData;e.append("token",this.$store.state.user.token),e.append("license",this.Licenseform.license),await(0,p.Kx)(e).then((e=>{(0,c.z8)({message:e.message,type:"success"}),this.LoadUserMessage(),this.LicenseFormVisible=!1}))}}))}}},h=o(40465);const b=(0,h.Z)(w,[["render",m],["__scopeId","data-v-085c95f5"]]);var y=b}}]);
//# sourceMappingURL=907.163f4b8a.js.map